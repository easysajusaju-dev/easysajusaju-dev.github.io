<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì´ì§€ì‚¬ì£¼ - ê²°ì œ ì™„ë£Œ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');
body {
  font-family:'Noto Sans KR',sans-serif;
  background:#f7f9fa; color:#333;
  min-height:100vh; display:flex; justify-content:center; align-items:center;
  margin:0; padding:20px; box-sizing:border-box;
}
.container {
  max-width:500px; width:100%;
  background:#fff; padding:40px; border-radius:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08); text-align:center;
}
.icon { font-size:40px; color:#2ecc71; }
h1 { font-size:26px; margin:20px 0 10px; }
p { font-size:16px; color:#555; line-height:1.6; margin-bottom:20px; }
.info-box, .order-summary {
  background:#f7f9fa; padding:20px; border-radius:8px; text-align:left; margin-bottom:20px;
}
.info-box h3, .order-summary h3 {
  font-size:18px; margin:0 0 10px; border-bottom:1px solid #e0e0e0; padding-bottom:8px;
}
.info-box ul, .order-summary ul { list-style:none; padding:0; margin:0; }
.info-box li, .order-summary li { font-size:15px; margin-bottom:7px; }
.home-button {
  display:inline-block; margin-top:20px; padding:12px 25px;
  font-size:16px; font-weight:700; background:#2c3e50; color:#fff;
  border-radius:30px; text-decoration:none;
}
</style>
</head>

<body>
<div class="container">
  <div id="statusIcon" class="icon">âŒ›</div>
  <h1 id="title">ê²°ì œ í™•ì¸ ì¤‘...</h1>
  <p id="message">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”. ì£¼ë¬¸ì„ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>

  <div class="order-summary">
      <h3>ì£¼ë¬¸ ì •ë³´</h3>
      <ul>
        <li><strong>ìƒí’ˆ:</strong> <span id="product-name"></span></li>
        <li><strong>ê¸ˆì•¡:</strong> <span id="product-price"></span>ì›</li>
      </ul>
  </div>

  <div class="info-box" id="nextStepsBox" style="display:none;">
      <h3>ì§„í–‰ ì•ˆë‚´</h3>
      <ul>
        <li>âœ… ê²°ì œê°€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</li>
        <li>ğŸ“„ ì‚¬ì£¼ ë¶„ì„ì´ ì§„í–‰ë©ë‹ˆë‹¤. (1~2ì¼ ì´ë‚´)</li>
        <li>ğŸ“© PDF ë¶„ì„ì§€ë¥¼ ì¹´ì¹´ì˜¤í†¡/ì´ë©”ì¼ë¡œ ë³´ë‚´ë“œë¦´ê²Œìš”!</li>
      </ul>
  </div>

  <a class="home-button" href="index.html">í™ˆìœ¼ë¡œ ê°€ê¸°</a>
</div>

<script>
const scriptURL = "YOUR_APPS_SCRIPT_URL_HERE"; // âœ… ë°˜ë“œì‹œ êµì²´!

const url = new URL(location.href);
const oid = url.searchParams.get("oid");
const resultCode = url.searchParams.get("resultCode");
const product = url.searchParams.get("product");
const price = url.searchParams.get("price");

document.getElementById("product-name").innerText = product || "-";
document.getElementById("product-price").innerText = Number(price || 0).toLocaleString();

async function updateStatus(payStatus){
  try{
    await fetch(scriptURL,{
      method:"POST",
      headers:{ "Content-Type":"application/x-www-form-urlencoded" },
      body:new URLSearchParams({
        mode:"updatePayment",
        orderId:oid,
        payStatus
      })
    });
  }catch(e){ console.log("update error",e); }
}

function showSuccess(){
  document.getElementById("statusIcon").innerText="âœ…";
  document.getElementById("title").innerText="ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!";
  document.getElementById("message").innerText="ì†Œì¤‘í•œ ì‹ ì²­ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ ğŸ™";
  document.getElementById("nextStepsBox").style.display="block";
}

function showFail(){
  document.getElementById("statusIcon").innerText="âŒ";
  document.getElementById("title").innerText="ê²°ì œ ì‹¤íŒ¨";
  document.getElementById("message").innerText="ê²°ì œê°€ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
}

(async ()=>{
  if(resultCode==="0000"){
    await updateStatus("ê²°ì œì™„ë£Œ");
    showSuccess();
  } else {
    await updateStatus("ê²°ì œì‹¤íŒ¨");
    showFail();
  }
})();
</script>
</body>
</html>
