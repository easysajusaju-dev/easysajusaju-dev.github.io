<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê²°ì œí•˜ê¸° - ì´ì§€ì‚¬ì£¼</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
:root {
  --primary-color: #4a5a73;
  --kakao-yellow: #FEE500;
  --naver-green: #03C75A;
  --text-dark: #212529;
  --text-light: #6C757D;
  --bg-light: #f8f9fa;
  --border-color: #dee2e6;
}
body { margin:0;font-family:'Noto Sans KR',sans-serif;background:var(--bg-light);color:var(--text-dark);}
.wrapper { max-width:480px;margin:0 auto;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.08);}
.header {display:flex;align-items:center;justify-content:center;padding:1rem;border-bottom:1px solid var(--border-color);}
.back-btn {position:absolute;left:1rem;font-size:1.5rem;background:none;border:none;cursor:pointer;}
.banner {position:relative;height:140px;color:#fff;padding:1rem;display:flex;flex-direction:column;justify-content:center;}
.banner .bg-img {position:absolute;inset:0;width:100%;height:100%;object-fit:cover;}
.banner::after {content:"";position:absolute;inset:0;background:rgba(0,0,0,0.4);}
.banner .text-content {position:relative;}
.title {font-size:1.7rem;font-weight:700;margin:.2rem 0;}
main {padding:1.5rem;}
.card {background:#fff;padding:1.3rem;border-radius:12px;margin-bottom:1rem;}
.price-info {display:flex;justify-content:space-between;margin:8px 0}
.price-info.total {font-size:1.2rem;font-weight:700;border-top:1px solid var(--border-color);padding-top:10px;margin-top:10px}
.payment-buttons {display:flex;flex-direction:column;gap:.7rem;margin-top:1.2rem;}
.sns-payment-group {display:flex;gap:.7rem;}
.btn {display:flex;align-items:center;justify-content:center;padding:.85rem;border:none;border-radius:8px;font-size:1rem;font-weight:700;cursor:pointer;}
.btn-kakao {background:var(--kakao-yellow);}
.btn-naver {background:var(--naver-green);color:#fff;}
.btn-primary {background:var(--primary-color);color:#fff;}
.btn img {height:16px;}
</style>
<script src="https://pay.nicepay.co.kr/v1/js/"></script>

</head>

<body>
<div class="wrapper">
<header class="header">
<button class="back-btn" onclick="history.back()">&lt;</button>
<h1>ê²°ì œí•˜ê¸°</h1>
</header>

<div class="banner">
<img src="/images/card-individual.png" class="bg-img">
<div class="text-content">
<p class="subtitle">ë‹¹ì‹ ì˜ ìš´ëª…ì„ í’€ì–´ë‚´ëŠ” ê³³</p>
<h2 class="title">ì´ì§€ì‚¬ì£¼</h2>
<p class="desc">ë³µì±„ ê²°ì œí•˜ê¸°</p>
</div>
</div>

<main>

<div class="card">
<h3 class="card-title">ê²°ì œ ê¸ˆì•¡</h3>

<div class="price-info">
    <span class="label" id="pay-product-name">ìƒí’ˆëª…</span>
    <span class="amount" id="pay-product-price">0ì›</span>
</div>

<div class="price-info">
    <span class="label">í• ì¸ ì ìš©</span>
    <span class="amount" id="pay-discount">-0ì›</span>
</div>

<div class="price-info total">
    <span class="label">ìµœì¢… ê²°ì œê¸ˆì•¡</span>
    <span class="amount" id="pay-final-price">0ì›</span>
</div>
</div>

<div class="payment-buttons">

<div class="sns-payment-group">
<button class="btn btn-kakao" onclick="requestPay('kakao')">
<img src="images/á„á…¡á„á…¡á„‹á…©á„‘á…¦á„‹á…µ_CI_combination_with_BG.png">ì¹´ì¹´ì˜¤í˜ì´ ê²°ì œ
</button>

<button class="btn btn-naver" onclick="alert('ğŸ›  ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤!')">
<img src="images/badge_npay.png">ë„¤ì´ë²„í˜ì´ ê²°ì œ
</button>
</div>

<button class="btn btn-primary" onclick="requestPay('card')">ì¼ë°˜ ê²°ì œ</button>

</div>
</main>
</div>

<script>
const API_BASE = "https://my-payment-server.vercel.app";

function getParam(k){ return new URLSearchParams(location.search).get(k); }

const oid     = getParam("oid");
const product = decodeURIComponent(getParam("product") || "");
const price   = Number(getParam("price") || 0);

// âœ… UI ì„¸íŒ…
document.addEventListener("DOMContentLoaded", () => {
  document.querySelector(".title").textContent = `ì´ì§€ì‚¬ì£¼ - ${product}`;
  document.getElementById("pay-product-name").textContent  = product;
  document.getElementById("pay-product-price").textContent = `${price.toLocaleString()}ì›`;
  document.getElementById("pay-final-price").textContent   = `${price.toLocaleString()}ì›`;
});

// âœ… ê²°ì œ ìš”ì²­

function requestPay(type) {

  if (type === "kakao") {
    location.href =
      `thankyou.html?oid=${encodeURIComponent(oid)}&product=${encodeURIComponent(product)}&price=${price}&method=kakao&success=1`;
    return;
  }

  if (type === "card") {
    AUTHNICE.requestPay({
      clientId: "R2_29330d4bbbe14f5c85925e52e48e0721",
      method: "card",
      orderId: oid,
      amount: price,
      goodsName: product,
      returnUrl: "https://easysajusaju-dev.github.io/payment-callback.html",

      fnError: function (err) {
        console.error("âŒ ì¸ì¦ ì˜¤ë¥˜:", err);
        alert("ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      },

      fnSuccess: function (res) {
        console.log("âœ… ì¸ì¦ ì„±ê³µ:", res);
        // (ì—¬ê¸°ì„œëŠ” ìŠ¹ì¸ê¹Œì§€ í•˜ì§€ ì•ŠìŒ â€” ì½œë°± í˜ì´ì§€ì—ì„œ ì²˜ë¦¬)
      }
    });
  }
}

</script>


</body>
</html>
