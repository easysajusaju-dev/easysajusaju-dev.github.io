<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ê²°ì œí•˜ê¸° - ì´ì§€ì‚¬ì£¼</title>

  <!-- NICEPAY ê²°ì œ ìŠ¤í¬ë¦½íŠ¸ (ë¼ì´ë¸Œ) -->
  <script src="https://pay.nicepay.co.kr/v1/js/"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');

    :root{
      --primary-color:#4a5a73;
      --kakao-yellow:#FEE500;
      --naver-green:#03C75A;
      --text-dark:#212529;
      --text-light:#6C757D;
      --bg-light:#f8f9fa;
      --border-color:#dee2e6;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:'Noto Sans KR',sans-serif;
      background:var(--bg-light);
      color:var(--text-dark);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrapper{max-width:480px;margin:0 auto;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,.08)}
    .header{
      display:flex;align-items:center;justify-content:center;
      position:sticky;top:0;z-index:10;
      background:#fff;padding:1rem;border-bottom:1px solid var(--border-color)
    }
    .back-btn{position:absolute;left:1rem;font-size:1.5rem;background:none;border:none;cursor:pointer}
    .banner{position:relative;height:140px;color:#fff;padding:1rem;display:flex;flex-direction:column;justify-content:center}
    .banner .bg-img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:1}
    .banner::after{content:"";position:absolute;inset:0;background:linear-gradient(to right,rgba(29,43,80,.7),rgba(44,62,80,.4));z-index:2}
    .banner .text-content{position:relative;z-index:3}
    .banner .subtitle{margin:0;font-size:.9rem;opacity:.9}
    .banner .title{margin:.25rem 0;font-size:2.1rem;font-weight:700}
    .banner .desc{margin:0;font-size:1.2rem;opacity:.95}

    main{padding:1.5rem}
    .card{background:#fff;border-radius:12px;padding:1.5rem;margin-bottom:1rem;border:1px solid var(--border-color)}
    .card-title{margin:0 0 .75rem 0;font-size:1.1rem;font-weight:700}
    .price-info{display:flex;justify-content:space-between;align-items:center;font-size:1rem;margin:.5rem 0}
    .price-info.total{font-size:1.2rem;font-weight:700;padding-top:1rem;border-top:1px solid var(--border-color)}

    .payment-buttons{display:flex;flex-direction:column;gap:.75rem;margin-top:1.25rem}
    .sns-payment-group{display:flex;gap:.75rem}
    .btn{display:flex;align-items:center;justify-content:center;width:100%;padding:.85rem 1rem;font-size:1rem;font-weight:700;border:none;border-radius:8px;cursor:pointer;gap:.5rem}
    .btn img{height:16px}
    .btn-kakao{background:var(--kakao-yellow);color:#000}
    .btn-naver{background:var(--naver-green);color:#fff}
    .btn-primary{background:var(--primary-color);color:#fff}
    .hint{font-size:.85rem;color:var(--text-light);margin-top:.5rem;line-height:1.5}

    .footer{padding:1.5rem;text-align:center;color:var(--text-light);font-size:.85rem}
  </style>
</head>
<body>
<div class="wrapper">
  <header class="header">
    <button class="back-btn" onclick="history.back()" aria-label="ë’¤ë¡œê°€ê¸°">&lt;</button>
    <h1>ê²°ì œí•˜ê¸°</h1>
  </header>

  <div class="banner">
    <img src="/images/card-individual.png" alt="" class="bg-img"/>
    <div class="text-content">
      <p class="subtitle">ë‹¹ì‹ ì˜ ìš´ëª…ì„ í’€ì–´ë‚´ëŠ” ê³³</p>
      <h2 class="title">ì´ì§€ì‚¬ì£¼</h2>
      <p class="desc">ë³µì±„ ê²°ì œí•˜ê¸°</p>
    </div>
  </div>

  <main>
    <!-- ì£¼ë¬¸/ê¸ˆì•¡ ì•ˆë‚´ -->
    <div class="card">
      <h3 class="card-title">ì£¼ë¬¸ ì •ë³´</h3>
      <div class="price-info"><span>ì£¼ë¬¸ë²ˆí˜¸</span><span id="oidText">-</span></div>
      <div class="price-info"><span>ìƒí’ˆëª…</span><span id="productName">-</span></div>
      <div class="price-info total"><span>ìµœì¢… ê²°ì œê¸ˆì•¡</span><span id="productPrice">-</span></div>
      <div class="hint">â€» ê²°ì œ ê¸ˆì•¡ì€ ì„œë²„ ê¸°ì¤€í‘œì™€ êµì°¨ê²€ì¦ë©ë‹ˆë‹¤.</div>
    </div>

    <!-- ê²°ì œ ë°©ì‹ -->
    <div class="card">
      <h3 class="card-title">ê²°ì œ ë°©ì‹</h3>
      <div class="payment-buttons">
        <div class="sns-payment-group">
          <button class="btn btn-kakao" type="button" id="kakaoBtn">
            <img src="images/á„á…¡á„á…¡á„‹á…©á„‘á…¦á„‹á…µ_CI_combination_with_BG.png" alt="ì¹´ì¹´ì˜¤í˜ì´"/>
            ì¹´ì¹´ì˜¤í˜ì´ (ì¤€ë¹„ì¤‘)
          </button>
          <button class="btn btn-naver" type="button" id="naverBtn">
            <img src="images/badge_npay.png" alt="ë„¤ì´ë²„í˜ì´"/>
            ë„¤ì´ë²„í˜ì´ (ì¤€ë¹„ì¤‘)
          </button>
        </div>

        <button class="btn btn-primary" type="button" id="cardBtn">ì¼ë°˜ ì¹´ë“œê²°ì œ</button>
        <div class="hint" id="errorBox" style="display:none;"></div>
      </div>
    </div>
  </main>

  <div class="footer">Â© 2025 ì´ì§€ì‚¬ì£¼</div>
</div>

<script>
/* ---------- í•˜ë“œì½”ë”© ê°€ê²©í‘œ(êµì°¨ê²€ì¦ìš©, ì„œë²„ ê¸°ì¤€ê³¼ ë™ì¼) ---------- */
const PRICE_TABLE = {
  "ì¢…í•©ì‚¬ì£¼ ë¯¸ë‹ˆ": 5000,
  "ì‹ ë…„ìš´ì„¸": 19900,
  "ì¢…í•©ì‚¬ì£¼": 34900,
  "ì¬ë¬¼ì‚¬ì£¼": 14900,
  "ê²°í˜¼ì‚¬ì£¼": 12900,
  "ì—°ì• ì‚¬ì£¼": 9900,
  "ì—°ì• íŒ¨í‚¤ì§€": 19900,
  "íƒ€ì´ë°íŒ¨í‚¤ì§€": 26900,
  "ì¸ìƒíŒ¨í‚¤ì§€": 39900,
  "ì¬íšŒìš´": 29900,
  "ê¶í•©ì‚¬ì£¼": 29900
};

/* ---------- ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° íŒŒì‹± ---------- */
const qs = new URLSearchParams(location.search);
const OID = qs.get('oid') || '';
const PRODUCT = qs.get('product') || '';
const PRICE_FROM_QUERY = Number(qs.get('price') || '0');

/* ---------- êµì°¨ ê²€ì¦ & UI ë°˜ì˜ ---------- */
(function initUI(){
  const realPrice = PRICE_TABLE[PRODUCT];
  if(!OID || !PRODUCT || !realPrice){
    alert("ì£¼ë¬¸ ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    location.replace("index.html");
    return;
  }
  if(realPrice !== PRICE_FROM_QUERY){
    alert("ê²°ì œê¸ˆì•¡ì´ ë³€ì¡°ë˜ì—ˆê±°ë‚˜ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    location.replace("index.html");
    return;
  }
  document.getElementById('oidText').textContent = OID;
  document.getElementById('productName').textContent = PRODUCT;
  document.getElementById('productPrice').textContent = realPrice.toLocaleString('ko-KR')+"ì›";
})();

/* ---------- ë²„íŠ¼ í•¸ë“¤ëŸ¬ ---------- */
document.getElementById('kakaoBtn').addEventListener('click', ()=> {
  alert("ì¹´ì¹´ì˜¤í˜ì´ëŠ” ê³§ ì—´ë¦½ë‹ˆë‹¤ ğŸ˜Š\nìš°ì„  'ì¼ë°˜ ì¹´ë“œê²°ì œ'ë¡œ ì§„í–‰í•´ì£¼ì„¸ìš”.");
});
document.getElementById('naverBtn').addEventListener('click', ()=> {
  alert("ë„¤ì´ë²„í˜ì´ëŠ” ê³§ ì—´ë¦½ë‹ˆë‹¤ ğŸ˜Š\nìš°ì„  'ì¼ë°˜ ì¹´ë“œê²°ì œ'ë¡œ ì§„í–‰í•´ì£¼ì„¸ìš”.");
});

/* ---------- NICEPAY í˜¸ì¶œ ---------- */
const CLIENT_ID = "R2_29330d4bbbe14f5c85925e52e48e0721"; // í¬ìŠ¤íƒ€íŠ¸ì—ì„œ ë°›ì€ Client Key
const RETURN_URL = location.origin + "/thankyou.html" 
  + `?oid=${encodeURIComponent(OID)}&product=${encodeURIComponent(PRODUCT)}&price=${encodeURIComponent(PRICE_FROM_QUERY)}`;

function openCardPay(){
  const realPrice = PRICE_TABLE[PRODUCT];
  if(typeof AUTHNICE === 'undefined' || !AUTHNICE.requestPay){
    showErr("ê²°ì œ ëª¨ë“ˆ ì´ˆê¸°í™” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    return;
  }
  try{
    // NICEPAY í˜¸ì¶œ
    AUTHNICE.requestPay({
      clientId : CLIENT_ID,
      method   : "card",            // ì¼ë°˜ ì¹´ë“œê²°ì œ
      orderId  : OID,               // ë„ˆê°€ ë§Œë“  ì˜¤ë”ID ê·¸ëŒ€ë¡œ
      amount   : realPrice,         // ë°˜ë“œì‹œ êµì°¨ê²€ì¦í•œ ê¸ˆì•¡
      goodsName: PRODUCT,           // í’ˆëª©ëª…
      returnUrl: RETURN_URL         // ê²°ì œ í›„ ëŒì•„ì˜¬ URL (thankyou.html)
    });
  }catch(e){
    console.error(e);
    showErr("ê²°ì œ í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e);
  }
}

function showErr(msg){
  const box = document.getElementById('errorBox');
  box.style.display = 'block';
  box.textContent = msg;
}

/* ì´ì¤‘ í´ë¦­ ë°©ì§€ + í´ë¦­ ë°”ì¸ë”© */
const cardBtn = document.getElementById('cardBtn');
let locking = false;
cardBtn.addEventListener('click', ()=>{
  if(locking) return;
  locking = true;
  cardBtn.disabled = true;
  cardBtn.textContent = "ê²°ì œì°½ ì—¬ëŠ” ì¤‘...";
  setTimeout(()=>{ // UXìš© ë”œë ˆì´
    openCardPay();
    // í˜¹ì‹œ ëª¨ë“ˆì´ íŒì—…/ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ë™ì•ˆ ë²„íŠ¼ì€ ë¹„í™œì„±í™” ìœ ì§€
    setTimeout(()=>{ locking=false; cardBtn.disabled=false; cardBtn.textContent="ì¼ë°˜ ì¹´ë“œê²°ì œ"; }, 6000);
  }, 150);
});
</script>
</body>
</html>
