<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>결제하기 - 이지사주</title>

<script src="https://cdn.portone.io/v2/browser-sdk.js"></script>

<style>
/* ----- 기존 CSS 유지 (생략) ----- */
/* 너가 준 CSS 영역 그대로 두세요 */
</style>
</head>
<body>

<div class="wrapper">
<header class="header">
<button class="back-btn" onclick="history.back()">&lt;</button>
<h1>결제하기</h1>
</header>

<div class="banner">
<img src="/images/card-individual.png" class="bg-img" />
<div class="text-content">
<p class="subtitle">당신의 운명을 풀어내는 곳</p>
<h2 class="title">이지사주 결제</h2>
<p class="desc">복채 결제하기</p>
</div>
</div>

<main>
<div class="card">
<h3 class="card-title">결제 정보</h3>
<div class="price-info">
<span class="label" id="productNameArea">상품명 불러오는 중...</span>
<span class="amount" id="productPriceArea"></span>
</div>
</div>

<!-- 결제 버튼 -->
<div class="payment-buttons">

<!-- 카카오페이 -->
<button class="btn btn-kakao" id="btnKakao">
<img src="images/kakao.png" style="height:16px;" /> 카카오페이 결제
</button>

<!-- 네이버페이 -->
<button class="btn btn-naver" id="btnNaver">
<img src="images/badge_npay.png" style="height:16px;" /> 네이버페이 결제
</button>

<!-- 일반 카드결제 -->
<button class="btn btn-primary" id="btnCard">카드 결제</button>

</div>
</main>

</div>

<script>
// ✅ URL에서 주문정보 가져오기
const urlParams = new URLSearchParams(window.location.search);
const orderId = urlParams.get("oid");
const productName = urlParams.get("product");
const price = Number(urlParams.get("price"));

// ✅ 화면에 표시
document.getElementById("productNameArea").textContent = productName;
document.getElementById("productPriceArea").textContent = price.toLocaleString() + "원";

// ✅ 포스타트 clientKey
const clientKey = "pk_test_85a6d05aa2f141c6803e4f02"; // 포스타트에서 받은 값

const returnUrl = `${window.location.origin}/thankyou.html`;

// ✅ 공통 결제 함수
async function pay(method) {
await PortOne.requestPayment({
storeId: "pg_nicepay",
channelKey: clientKey,
paymentId: orderId,
orderName: productName,
totalAmount: price,
currency: "KRW",
payMethod: method,
redirectUrl: `${returnUrl}?oid=${orderId}&paid=1&price=${price}&product=${productName}`,
});
}

// ✅ 버튼 연결
document.getElementById("btnKakao").onclick = () => pay("KAKAOPAY");
document.getElementById("btnNaver").onclick = () => pay("NAVERPAY");
document.getElementById("btnCard").onclick = () => pay("CARD");

</script>

</body>
</html>

