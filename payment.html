<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />

   <!-- ==================== â­ íŒŒë¹„ì½˜ ì„¤ì • ì½”ë“œ (ì „ì²´ ì£¼ì†Œ) ==================== -->
<link rel="apple-touch-icon" sizes="180x180" href="https://easysaju-test.vercel.app/images/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://easysaju-test.vercel.app/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://easysaju-test.vercel.app/images/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://easysaju-test.vercel.app/images/favicon-16x16.png">
<link rel="shortcut icon" href="https://easysaju-test.vercel.app/images/favicon.ico">

<!-- MS(ìœˆë„ìš°) íƒ€ì¼ìš© ì•„ì´ì½˜ ë° ìƒ‰ìƒ ì„¤ì • -->
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="https://easysaju-test.vercel.app/images/ms-icon-144x144.png">
<!-- ======================================================================= -->
 
 <!-- ================== â­ ì†Œì…œ ê³µìœ (ì˜¤í”ˆ ê·¸ë˜í”„) ì„¤ì • ì½”ë“œ ================== -->
  <meta property="og:title" content="ì´ì§€ì‚¬ì£¼">
  <meta property="og:description" content="13ë…„ ëª…ë¦¬ì „ë¬¸ê°€ê°€ ë¶„ì„í•´ ë“œë¦¬ëŠ” ë‹¹ì‹ ì˜ ìš´ì„¸">
  <meta property="og:image" content="https://easysaju-test.vercel.app/images/share.png">
  <meta property="og:url" content="https://easysaju-test.vercel.app/">
  <meta property="og:type" content="website">
<!-- ======================================================================= -->
  
  <title>ê²°ì œí•˜ê¸° - ì´ì§€ì‚¬ì£¼</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
    :root {
      --primary-color:#4a5a73;
      --kakao-yellow:#FEE500;
      --naver-green:#03C75A;
      --toss-blue:#0064FF;
      --text-dark:#212529;
      --text-light:#6C757D;
      --bg-light:#f8f9fa;
      --border-color:#dee2e6;
    }

    body {
      margin:0;
      font-family:'Noto Sans KR',sans-serif;
      background:var(--bg-light);
      color:var(--text-dark);
    }

    .wrapper {
      max-width:480px;
      margin:0 auto;
      background:#fff;
      box-shadow:0 4px 12px rgba(0,0,0,.08);
    }

    .header {
      display:flex;
      align-items:center;
      justify-content:center;
      position:sticky;
      top:0;
      z-index:10;
      width:100%;
      background:#fff;
      padding:1rem;
      border-bottom:1px solid var(--border-color);
      box-sizing:border-box;
    }

    .header .back-btn {
      position:absolute;
      left:1rem;
      font-size:1.5rem;
      background:none;
      border:none;
      cursor:pointer;
    }

    .header h1 {
      margin:0;
      font-size:1.1rem;
      font-weight:500;
    }

    .banner {
      position:relative;
      width:100%;
      height:140px;
      color:#fff;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      flex-direction:column;
      padding:1rem;
      box-sizing:border-box;
    }

    .banner .bg-img {
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      object-position:center;
      z-index:1;
    }

    .banner::after {
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(to right,rgba(29,43,80,.7),rgba(44,62,80,.4));
      z-index:2;
    }

    .banner .text-content {
      position:relative;
      z-index:3;
    }

    .banner .subtitle { font-size:.9rem;opacity:.9;margin:0; }
    .banner .title { font-size:2.1rem;font-weight:700;margin:.25rem 0; }
    .banner .desc { font-size:1.2rem;opacity:.95;margin:0; }

    main { padding:1.5rem;background:var(--bg-light); }

    .card {
      background:#fff;
      border-radius:12px;
      padding:1.5rem;
      margin-bottom:1rem;
    }

    .card:last-child { margin-bottom:0; }

    .card-title { font-size:1.1rem;font-weight:700;margin:.0 0 .5rem; }
    .card-desc { font-size:.85rem;color:var(--text-light);margin:.0 0 1.5rem; }

    .phone-inputs {
      display:grid;
      grid-template-columns:1fr auto 1fr auto 1fr;
      gap:.5rem;
      align-items:center;
    }

    .phone-inputs select,
    .phone-inputs input {
      width:100%;
      padding:.75rem;
      border:1px solid var(--border-color);
      border-radius:8px;
      font-size:1rem;
      text-align:center;
      box-sizing:border-box;
    }

    .phone-inputs span { text-align:center;color:var(--text-light); }

    .price-info {
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:1rem;
      margin-bottom:1rem;
    }

    .price-info.total {
      font-size:1.2rem;
      font-weight:700;
      padding-top:1rem;
      margin-top:1rem;
      border-top:1px solid var(--border-color);
    }

    .price-info .label .discount {
      display:inline-block;
      font-size:.75rem;
      font-weight:700;
      color:#fff;
      background:#007bff;
      padding:2px 6px;
      border-radius:4px;
      margin-left:.5rem;
    }

    .price-info .amount { font-weight:500; }

    .agreements { margin-top:1.5rem; }

    .agreement-item {
      display:flex;
      align-items:center;
      margin-bottom:.5rem;
      font-size:.9rem;
    }

    .agreement-item input { margin-right:.5rem; }
    .agreement-item a { color:var(--text-light);text-decoration:underline; }

    .payment-buttons {
      display:flex;
      flex-direction:column;
      gap:.75rem;
      margin-top:1.5rem;
    }

    .sns-payment-group {
      display:flex;
      gap:.75rem;
      flex-wrap:wrap;
    }

    .btn {
      display:flex;
      align-items:center;
      justify-content:center;
      width:100%;
      padding:.85rem 1rem;
      font-size:1rem;
      font-weight:700;
      border:none;
      border-radius:8px;
      cursor:pointer;
      gap:.5rem;
    }

    .btn-kakao { background:var(--kakao-yellow); }
    .btn-naver { background:var(--naver-green);color:#fff; }
    .btn-toss { background:var(--toss-blue);color:#fff; }
    .btn-primary { background:var(--primary-color);color:#fff; }
    .btn img { height:16px; }

    .footer { padding:2rem 1rem;background:var(--bg-light);text-align:center; }

    .social-icons {
      display:flex;
      justify-content:center;
      gap:1rem;
      margin-bottom:1.5rem;
    }

    .social-icons a img {
      height:28px;
      opacity:.7;
      transition:opacity .2s;
    }

    .social-icons a:hover img { opacity:1; }

    .footer-links { margin-bottom:1rem;font-size:.9rem; }
    .footer-links a { color:var(--text-dark);text-decoration:none; }
    .footer-links .link-divider { margin:0 .5rem;color:var(--border-color); }

    .info-toggle {
      cursor:pointer;
      color:var(--text-light);
      font-size:.9rem;
      padding:.5rem;
      margin-bottom:1rem;
    }

    .info-details {
      display:none;
      text-align:center;
      font-size:.8rem;
      color:var(--text-light);
      line-height:1.6;
      background:#f1f3f5;
      padding:1rem;
      border-radius:8px;
      margin-bottom:1.5rem auto;
      max-width:90%;
    }

    .info-details p { margin:.25rem 0; }
    .info-details.show { display:block; }
    .copyright { font-size:.75rem;color:#adb5bd;margin-top:1rem; }

    @media (max-width:420px) {
      .sns-payment-group .btn {
        font-size:0.9rem;
        padding:0.8rem 0.4rem;
        white-space:nowrap;
      }
    }
  </style>

  <script src="https://pay.nicepay.co.kr/v1/js/"></script>
</head>

<body>
  <div class="wrapper">

    <!-- ===== Header ===== -->
    <header class="header">
      <button class="back-btn" onclick="history.back()">&lt;</button>
      <h1>ê²°ì œí•˜ê¸°</h1>
    </header>

    <!-- ===== Banner ===== -->
    <div class="banner">
      <img src="/images/card-individual.png" alt="" class="bg-img" />
      <div class="text-content">
        <p class="subtitle">ë‹¹ì‹ ì˜ ìš´ëª…ì„ í’€ì–´ë‚´ëŠ” ê³³</p>
        <h2 class="title" id="hero-title">ì´ì§€ì‚¬ì£¼</h2>
        <p class="desc">ë³µì±„ ê²°ì œí•˜ê¸°</p>
      </div>
    </div>

    <!-- ===== Main ===== -->
    <main>
      <!-- ê²°ì œ ê¸ˆì•¡ ì¹´ë“œ -->
      <div class="card">
        <h3 class="card-title">ê²°ì œ ê¸ˆì•¡</h3>

        <div class="price-info">
          <span class="label" id="pay-product-name">ìƒí’ˆëª…</span>
          <span class="amount" id="pay-product-price">0ì›</span>
        </div>

        <div class="price-info">
          <span class="label">í• ì¸ ì ìš© 
            <span class="discount" id="discount-badge" style="display:none;">-30%</span>
          </span>
          <span class="amount" id="pay-discount">-0ì›</span>
        </div>

        <div class="price-info total">
          <span class="label">ìµœì¢… ê²°ì œê¸ˆì•¡</span>
          <span class="amount" id="pay-final-price">0ì›</span>
        </div>

        <!-- ê²°ì œ ë²„íŠ¼ ì˜ì—­ -->
        <style>
          .payment-buttons {
            display:flex;
            flex-direction:column;
            gap:0.9rem;
            margin-top:1.5rem;
          }

          .sns-payment-group {
            display:flex;
            gap:0.9rem;
            flex-wrap:wrap;
          }

          .btn {
            position:relative;
            display:flex;
            align-items:center;
            justify-content:center;
            flex:1;
            padding:0.9rem 1rem;
            border:none;
            border-radius:12px;
            font-size:1rem;
            font-weight:600;
            cursor:pointer;
            transition:all 0.2s ease;
            box-shadow:0 3px 8px rgba(0,0,0,0.1);
          }

          .btn:hover {
            transform:translateY(-2px);
            box-shadow:0 4px 12px rgba(0,0,0,0.15);
          }

          .btn svg {
            margin-right:8px;
            height:20px;
            width:20px;
          }

          .btn-kakao {
            background:linear-gradient(145deg,#FFE870,#FDD835);
            color:#222;
          }

          .btn-naver {
            background:linear-gradient(145deg,#4ADE80,#16A34A);
            color:#fff;
          }

          .btn-card {
            background:linear-gradient(145deg,#A3E9F0,#7DE1E8);
            color:#003f45;
          }
        </style>

        <div class="payment-buttons">
          <div class="sns-payment-group">
            <!-- ì¹´ì¹´ì˜¤í˜ì´ -->
            <button class="btn btn-kakao" onclick="requestPay('kakaopay')">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
                <path d="M12 2C6.48 2 2 5.58 2 10c0 2.63 1.71 4.96 4.38 6.36L5 22l5.23-3.6c.58.09 1.17.14 1.77.14 5.52 0 10-3.58 10-8s-4.48-8-10-8z" fill="#000"/>
              </svg>
              ì¹´ì¹´ì˜¤í˜ì´ ê²°ì œ
            </button>


          <!-- ì‹ ìš©ì¹´ë“œê²°ì œ -->
          <button class="btn btn-card" onclick="requestPay('card')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="#003f45" stroke-width="2">
              <rect x="3" y="5" width="18" height="14" rx="2" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
            ì‹ ìš©ì¹´ë“œê²°ì œ
          </button>
        </div>

        <p style="text-align:center; color:#adb5bd; font-size:0.85rem; margin-top:1.5rem;">
          ë³µì±„ ê²°ì œëŠ” ê²°ì œëŒ€í–‰ì‚¬ NICEPAYë¥¼ í†µí•´ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.<br>
          ê²°ì œ ë‚´ì—­ì€ ìƒë‹´ ì™„ë£Œ ì‹œê¹Œì§€ ì´ì§€ì‚¬ì£¼ì—ì„œ ì•ˆì „í•˜ê²Œ ë³´ê´€ë©ë‹ˆë‹¤.
        </p>
      </div>
    </main>

    <!-- ===== Footer ===== -->
    <footer class="footer">
      <div class="social-icons">
        <a href="http://pf.kakao.com/_xkAevn" target="_blank" title="ì¹´ì¹´ì˜¤ì±„ë„">
          <img src="images/kakaotalk.png" alt="ì¹´ì¹´ì˜¤ì±„ë„" />
        </a>
        <a href="https://www.threads.com/@easy.saju?hl=ko" target="_blank" title="ìŠ¤ë ˆë“œ">
          <img src="images/threads.png" alt="ìŠ¤ë ˆë“œ" />
        </a>
        <a href="https://www.instagram.com/easy.saju" target="_blank" title="ì¸ìŠ¤íƒ€ê·¸ë¨">
          <img src="images/instagram.png" alt="ì¸ìŠ¤íƒ€ê·¸ë¨" />
        </a>
        <a href="https://www.youtube.com/channel/UCLQGqG5Vy2WcTaKbvYOwHLA?sub_confirmation=1" target="_blank" title="ìœ íŠœë¸Œ">
          <img src="images/youtube.png" alt="ìœ íŠœë¸Œ" />
        </a>
        <a href="https://www.tiktok.com/@easysaju" target="_blank" title="í‹±í†¡">
          <img src="images/tiktok.png" alt="í‹±í†¡" />
        </a>
      </div>

      <div class="footer-links">
        <a href="terms.html">ì´ìš©ì•½ê´€</a>
        <span class="link-divider">Â·</span>
        <a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
      </div>

      <div class="info-toggle" id="info-toggle-button">
        ì´ì§€ì‚¬ì£¼ ì‚¬ì—…ìì •ë³´ <span id="info-arrow">â–¼</span>
      </div>

      <div class="info-details" id="business-info-details">
        <p>ìƒí˜¸ëª…: ì´ì§€ì‚¬ì£¼ | ëŒ€í‘œ: ì•ˆë¯¸ì •</p>
        <p>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 550-64-00884</p>
        <p>í†µì‹ íŒë§¤ë²ˆí˜¸: ì œ2025-ê³ ì–‘ì¼ì‚°ë™-1332í˜¸</p>
        <p>ì´ë©”ì¼: easysaju.saju@gmail.com</p>
        <p>ì „í™”: 010-2151-3949</p>
      </div>

      <p class="copyright">Â© 2025 ì´ì§€ì‚¬ì£¼. All rights reserved.</p>
    </footer>
  </div>

  <!-- ===== Script ===== -->
  <script>
    const API_BASE = "https://my-payment-server-test.vercel.app";
    const token = new URLSearchParams(location.search).get("token");

    let ORDER = null; // { orderId, goodsName, amount }

// âœ… í˜ì´ì§€ ë¡œë“œ ì‹œ í† í° ê²€ì¦ + ì˜ˆìœ ê°€ê²© í‘œì‹œ (ì •ê°€ ì²œì›ë‹¨ìœ„ ë°˜ì˜¬ë¦¼ + ì •ìˆ˜ í• ì¸ìœ¨)
document.addEventListener("DOMContentLoaded", async () => {
  try {
    if (!token) throw new Error("í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ê²°ì œ ë§í¬ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");

    const r = await fetch(`${API_BASE}/api/pay/order-info?token=${encodeURIComponent(token)}`);
    const data = await r.json();
    if (!data.ok) throw new Error(data.error || "ì£¼ë¬¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");

    ORDER = {
      orderId: data.orderId,
      goodsName: data.goodsName,
      amount: Number(data.amount)
    };

    // âœ… ìµœì¢… ê²°ì œê¸ˆì•¡ (ì‹œíŠ¸ ê¸ˆì•¡)
    const F = ORDER.amount;

    // âœ… ê¸°ì¤€ í• ì¸ìœ¨(ì—­ì‚°ìš©)
    const BASE_DISCOUNT = 0.3;

    // 1ï¸âƒ£ ì •ê°€ ê³„ì‚° (30% í• ì¸ ì—­ì‚° í›„ ì²œì›ë‹¨ìœ„ ë°˜ì˜¬ë¦¼)
    let rawOriginal = F / (1 - BASE_DISCOUNT);
    let original = Math.round(rawOriginal / 1000) * 1000;

    // 2ï¸âƒ£ ì •ê°€ê°€ ì‹¤ì œ ê²°ì œê¸ˆì•¡ë³´ë‹¤ ì‘ê²Œ ë‚˜ì˜¤ëŠ” ê²½ìš° ë³´ì •
    if (original <= F) original = Math.ceil((F + 1) / 1000) * 1000;

    // 3ï¸âƒ£ ì‹¤ì œ í• ì¸ìœ¨ ê³„ì‚° (ì •ìˆ˜ ë°˜ì˜¬ë¦¼)
    const rate = Math.round((1 - F / original) * 100);
    const discount = original - F;

    // âœ… í™”ë©´ í‘œì‹œ
    document.getElementById("hero-title").textContent = `ì´ì§€ì‚¬ì£¼ - ${ORDER.goodsName}`;
    document.getElementById("pay-product-name").textContent = ORDER.goodsName;
    document.getElementById("pay-product-price").textContent = `${original.toLocaleString()}ì›`;
    document.getElementById("pay-discount").textContent = `-${discount.toLocaleString()}ì›`;
    document.getElementById("pay-final-price").textContent = `${F.toLocaleString()}ì›`;

    // âœ… í• ì¸ìœ¨ ë°°ì§€ í‘œì‹œ
    const badge = document.getElementById("discount-badge");
    if (badge) {
      badge.textContent = `-${rate}%`;
      badge.style.display = "inline-block";
    }

  } catch (e) {
    console.error("âŒ ê²°ì œì •ë³´ ë¡œë“œ ì‹¤íŒ¨:", e);
    alert(e.message || "ì£¼ë¬¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
  }
});

    // âœ… ê²°ì œ ìš”ì²­ í•¨ìˆ˜
    function requestPay(type) {
      if (!ORDER) {
        alert("ì£¼ë¬¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        return;
      }

      console.log("ğŸš€ ê²°ì œìš”ì²­ ë°ì´í„°:", {
        orderId: ORDER.orderId,
        goodsName: ORDER.goodsName,
        amount: ORDER.amount,
        returnUrl: `${API_BASE}/api/pay/callback`
      });

      AUTHNICE.requestPay({
        clientId: "R2_29330d4bbbe14f5c85925e52e48e0721",
        method: type,
        orderId: ORDER.orderId,
        amount: ORDER.amount,
        goodsName: ORDER.goodsName,
        returnUrl: `${API_BASE}/api/pay/callback`,
        fnError: function (err) {
          console.error("âŒ ì¸ì¦ ì˜¤ë¥˜:", err);
          alert("ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        },
        fnSuccess: function (res) {
          console.log("âœ… ì¹´ë“œ ì¸ì¦ ì„±ê³µ:", res);
        }
      });
    }

    // âœ… ì‚¬ì—…ìì •ë³´ í† ê¸€
    document.addEventListener('DOMContentLoaded', function() {
      const toggleButton = document.getElementById('info-toggle-button');
      const details = document.getElementById('business-info-details');
      const arrow = document.getElementById('info-arrow');
      if (toggleButton) {
        toggleButton.addEventListener('click', function() {
          details.classList.toggle('show');
          arrow.textContent = details.classList.contains('show') ? 'â–²' : 'â–¼';
          details.style.textAlign = 'center';
        });
      }
    });
  </script>
</body>
</html>
