<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>ê²°ì œí•˜ê¸° - ì´ì§€ì‚¬ì£¼</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
    :root{
      --primary-color:#4a5a73;--kakao-yellow:#FEE500;--naver-green:#03C75A;--toss-blue:#0064FF;
      --text-dark:#212529;--text-light:#6C757D;--bg-light:#f8f9fa;--border-color:#dee2e6;
    }
    body{margin:0;font-family:'Noto Sans KR',sans-serif;background:var(--bg-light);color:var(--text-dark);}
    .wrapper{max-width:480px;margin:0 auto;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,.08);}
    .header{display:flex;align-items:center;justify-content:center;position:sticky;top:0;z-index:10;width:100%;
      background:#fff;padding:1rem;border-bottom:1px solid var(--border-color);box-sizing:border-box;}
    .header .back-btn{position:absolute;left:1rem;font-size:1.5rem;background:none;border:none;cursor:pointer;}
    .header h1{margin:0;font-size:1.1rem;font-weight:500;}
    .banner{position:relative;width:100%;height:140px;color:#fff;display:flex;align-items:flex-start;justify-content:center;
      flex-direction:column;padding:1rem;box-sizing:border-box;}
    .banner .bg-img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;object-position:center;z-index:1;}
    .banner::after{content:"";position:absolute;inset:0;background:linear-gradient(to right,rgba(29,43,80,.7),rgba(44,62,80,.4));z-index:2;}
    .banner .text-content{position:relative;z-index:3;}
    .banner .subtitle{font-size:.9rem;opacity:.9;margin:0;}
    .banner .title{font-size:2.1rem;font-weight:700;margin:.25rem 0;}
    .banner .desc{font-size:1.2rem;opacity:.95;margin:0;}
    main{padding:1.5rem;background:var(--bg-light);}
    .card{background:#fff;border-radius:12px;padding:1.5rem;margin-bottom:1rem;}
    .card:last-child{margin-bottom:0;}
    .card-title{font-size:1.1rem;font-weight:700;margin:.0 0 .5rem;}
    .card-desc{font-size:.85rem;color:var(--text-light);margin:.0 0 1.5rem;}
    .phone-inputs{display:grid;grid-template-columns:1fr auto 1fr auto 1fr;gap:.5rem;align-items:center;}
    .phone-inputs select,.phone-inputs input{width:100%;padding:.75rem;border:1px solid var(--border-color);border-radius:8px;font-size:1rem;text-align:center;box-sizing:border-box;}
    .phone-inputs span{text-align:center;color:var(--text-light);}
    .price-info{display:flex;justify-content:space-between;align-items:center;font-size:1rem;margin-bottom:1rem;}
    .price-info.total{font-size:1.2rem;font-weight:700;padding-top:1rem;margin-top:1rem;border-top:1px solid var(--border-color);}
    .price-info .label .discount{display:inline-block;font-size:.75rem;font-weight:700;color:#fff;background:#007bff;padding:2px 6px;border-radius:4px;margin-left:.5rem;}
    .price-info .amount{font-weight:500;}
    .agreements{margin-top:1.5rem;}
    .agreement-item{display:flex;align-items:center;margin-bottom:.5rem;font-size:.9rem;}
    .agreement-item input{margin-right:.5rem;}
    .agreement-item a{color:var(--text-light);text-decoration:underline;}
    .payment-buttons{display:flex;flex-direction:column;gap:.75rem;margin-top:1.5rem;}
    .sns-payment-group{display:flex;gap:.75rem;flex-wrap:wrap;}
    .btn{display:flex;align-items:center;justify-content:center;width:100%;padding:.85rem 1rem;font-size:1rem;font-weight:700;border:none;border-radius:8px;cursor:pointer;gap:.5rem;}
    .btn-kakao{background:var(--kakao-yellow);}
    .btn-naver{background:var(--naver-green);color:#fff;}
    .btn-toss{background:var(--toss-blue);color:#fff;}
    .btn-primary{background:var(--primary-color);color:#fff;}
    .btn img{height:16px;}
    .footer{padding:2rem 1rem;background:var(--bg-light);text-align:center;}
    .social-icons{display:flex;justify-content:center;gap:1rem;margin-bottom:1.5rem;}
    .social-icons a img{height:28px;opacity:.7;transition:opacity .2s;}
    .social-icons a:hover img{opacity:1;}
    .footer-links{margin-bottom:1rem;font-size:.9rem;}
    .footer-links a{color:var(--text-dark);text-decoration:none;}
    .footer-links .link-divider{margin:0 .5rem;color:var(--border-color);}
    .info-toggle{cursor:pointer;color:var(--text-light);font-size:.9rem;padding:.5rem;margin-bottom:1rem;}
    .info-details{display:none;text-align:center;font-size:.8rem;color:var(--text-light);line-height:1.6;background:#f1f3f5;padding:1rem;border-radius:8px;margin-bottom:1.5rem auto; max-width: 90%;}
    .info-details p{margin:.25rem 0;}
    .info-details.show{display:block;}
    .copyright{font-size:.75rem;color:#adb5bd;margin-top:1rem;}
  </style>
  <script src="https://pay.nicepay.co.kr/v1/js/"></script>
</head>
<body>
  <div class="wrapper">
    <header class="header">
      <button class="back-btn" onclick="history.back()">&lt;</button>
      <h1>ê²°ì œí•˜ê¸°</h1>
    </header>

    <div class="banner">
      <img src="/images/card-individual.png" alt="" class="bg-img" />
      <div class="text-content">
        <p class="subtitle">ë‹¹ì‹ ì˜ ìš´ëª…ì„ í’€ì–´ë‚´ëŠ” ê³³</p>
        <h2 class="title" id="hero-title">ì´ì§€ì‚¬ì£¼</h2>
        <p class="desc">ë³µì±„ ê²°ì œí•˜ê¸°</p>
      </div>
    </div>

    <main>
      <!-- ê²°ì œ ê¸ˆì•¡ -->
      <div class="card">
        <h3 class="card-title">ê²°ì œ ê¸ˆì•¡</h3>
        <div class="price-info">
          <span class="label" id="pay-product-name">ìƒí’ˆëª…</span>
          <span class="amount" id="pay-product-price">0ì›</span>
        </div>
        <div class="price-info">
          <span class="label">í• ì¸ ì ìš© <span class="discount" id="discount-badge" style="display:none;">-30%</span></span>
          <span class="amount" id="pay-discount">-0ì›</span>
        </div>
        <div class="price-info total">
          <span class="label">ìµœì¢… ê²°ì œê¸ˆì•¡</span>
          <span class="amount" id="pay-final-price">0ì›</span>
        </div>

        <!-- ê²°ì œ ë²„íŠ¼ë“¤ -->
        <div class="payment-buttons">
          <div class="sns-payment-group">
            <button class="btn btn-kakao" onclick="requestPay('kakaopay')">
              <img src="images/á„á…¡á„á…¡á„‹á…©á„‘á…¦á„‹á…µ_CI_combination_with_BG.png" alt="ì¹´ì¹´ì˜¤í˜ì´" />
              <span>ì¹´ì¹´ì˜¤í˜ì´ ê²°ì œ</span>
            </button>
            <button class="btn btn-naver" onclick="requestPay('naverpay')">
              <img src="images/badge_npay.png" alt="ë„¤ì´ë²„í˜ì´" />
              <span>ë„¤ì´ë²„í˜ì´ ê²°ì œ</span>
            </button>
            </div>
          <button class="btn btn-primary" onclick="requestPay('card')">ì‹ ìš©ì¹´ë“œ ê²°ì œ</button>
        </div>
      </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="footer">
      <div class="social-icons">
        <a href="http://pf.kakao.com/_xkAevn" target="_blank" title="ì¹´ì¹´ì˜¤ì±„ë„"><img src="images/kakaotalk.png" alt="ì¹´ì¹´ì˜¤ì±„ë„" /></a>
        <a href="https://www.threads.com/@easy.saju?hl=ko" target="_blank" title="ìŠ¤ë ˆë“œ"><img src="images/threads.png" alt="ìŠ¤ë ˆë“œ" /></a>
        <a href="https://www.instagram.com/easy.saju" target="_blank" title="ì¸ìŠ¤íƒ€ê·¸ë¨"><img src="images/instagram.png" alt="ì¸ìŠ¤íƒ€ê·¸ë¨" /></a>
        <a href="https://www.youtube.com/channel/UCLQGqG5Vy2WcTaKbvYOwHLA?sub_confirmation=1" target="_blank" title="ìœ íŠœë¸Œ"><img src="images/youtube.png" alt="ìœ íŠœë¸Œ" /></a>
        <a href="https://www.tiktok.com/@easysaju" target="_blank" title="í‹±í†¡"><img src="images/tiktok.png" alt="í‹±í†¡" /></a>
      </div>

      <div class="footer-links">
        <a href="terms.html">ì´ìš©ì•½ê´€</a>
        <span class="link-divider">Â·</span>
        <a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
      </div>

      <div class="info-toggle" id="info-toggle-button">
        ì´ì§€ì‚¬ì£¼ ì‚¬ì—…ìì •ë³´ <span id="info-arrow">â–¼</span>
      </div>
      <div class="info-details" id="business-info-details">
        <p>ìƒí˜¸ëª…: ì´ì§€ì‚¬ì£¼ | ëŒ€í‘œ: ì•ˆë¯¸ì •</p>
        <p>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 550-64-00884</p>
        <p>í†µì‹ íŒë§¤ë²ˆí˜¸: ì œ2025-ê³ ì–‘ì¼ì‚°ë™-1332í˜¸</p>
        <p>ì´ë©”ì¼: easysaju.saju@gmail.com</p>
        <p>ì „í™”: 010-2151-3949</p>
      </div>

      <p class="copyright">Â© 2025 ì´ì§€ì‚¬ì£¼. All rights reserved.</p>
    </footer>
  </div>

<script>
const API_BASE = "https://my-payment-server.vercel.app";

function getParam(k){ return new URLSearchParams(location.search).get(k); }
function num(v){ return Number(v||0) || 0; }

// URL íŒŒë¼ë¯¸í„°
const OID     = getParam("oid");
const PRODUCT = decodeURIComponent(getParam("product") || "");
const PRICE   = num(getParam("price")); // ì‹¤ì œ ê²°ì œ ê¸ˆì•¡ (ì‹œíŠ¸ì˜ í• ì¸ëœ ê¸ˆì•¡)
const DISCOUNT_RATE = 30; // âœ… ê³ ì • í• ì¸ìœ¨ 30%

// âœ… í™”ë©´ ì„¸íŒ… (ì›ê°€ ê³„ì‚° + í‘œì‹œ)
document.addEventListener("DOMContentLoaded", () => {
  const originalPrice = Math.round(PRICE / (1 - DISCOUNT_RATE / 100)); // ì›ê°€ ì—­ì‚°
  const discountAmount = originalPrice - PRICE;

  // ìƒí’ˆ ì •ë³´ í‘œì‹œ
  document.getElementById("hero-title").textContent = `ì´ì§€ì‚¬ì£¼ - ${PRODUCT || 'ìƒí’ˆ'}`;
  document.getElementById("pay-product-name").textContent  = PRODUCT || 'ìƒí’ˆëª…';
  document.getElementById("pay-product-price").textContent = `${originalPrice.toLocaleString()}ì›`;
  document.getElementById("pay-discount").textContent      = `-${discountAmount.toLocaleString()}ì›`;
  document.getElementById("pay-final-price").textContent   = `${PRICE.toLocaleString()}ì›`;

  // í• ì¸ìœ¨ ë°°ì§€ (ìˆìœ¼ë©´ í‘œì‹œ)
  const badge = document.getElementById("discount-badge");
  if (badge) {
    badge.style.display = "inline-block";
    badge.textContent = `-${DISCOUNT_RATE}%`;
  }
});

// âœ… í†µí•© ê²°ì œ í•¨ìˆ˜
function requestPay(type){
  const oid = OID;
  const product = PRODUCT;
  const amount = PRICE; // í• ì¸ëœ ê²°ì œê¸ˆì•¡

   // í˜„ì¬ ì¹´ë“œë§Œ ê°€ëŠ¥
  if(type !== "card"){
    alert("ğŸ›  í•´ë‹¹ ê²°ì œìˆ˜ë‹¨ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤. (í˜„ì¬: ì¹´ë“œë§Œ ê°€ëŠ¥)");
    return;
  }

  // âœ… NICEPAY ê²°ì œ ìš”ì²­
  AUTHNICE.requestPay({
    clientId: "R2_29330d4bbbe14f5c85925e52e48e0721",
    method: "card",
    orderId: oid,
    amount: amount,
    goodsName: product,
    returnUrl: `${API_BASE}/api/pay/callback`,

    fnError: function(err){
      console.error("âŒ ì¸ì¦ ì˜¤ë¥˜:", err);
      alert("ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    },
    fnSuccess: function(res){
      console.log("âœ… ì¹´ë“œ ì¸ì¦ ì„±ê³µ:", res);
      alert("ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
    }
  });
}

// âœ… í‘¸í„° í† ê¸€ (ì‚¬ì—…ìì •ë³´ ì—´ê¸°/ë‹«ê¸°)
document.addEventListener('DOMContentLoaded', function() {
  const toggleButton = document.getElementById('info-toggle-button');
  const details = document.getElementById('business-info-details');
  const arrow = document.getElementById('info-arrow');
  if (toggleButton) {
    toggleButton.addEventListener('click', function() {
      details.classList.toggle('show');
      arrow.textContent = details.classList.contains('show') ? 'â–²' : 'â–¼';
      details.style.textAlign = 'center'; // âœ… ê°€ìš´ë° ì •ë ¬ ì¶”ê°€
    });
  }
});
</script>

</body>
</html>
